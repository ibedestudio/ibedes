---
import Layout from "./Layout.astro";
import Section from "../components/common/Section.astro";
import { GLOBAL } from "../lib/variables";

type Hero = {
  title?: string;
  subtitle?: string;
  image?: string; // contoh: "/images/microsoft_dicoding.jpg" atau URL absolut
};

interface Props {
  title: string;
  description: string;
  canonicalUrl: string;
  hero?: Hero;
}

const { title, description, canonicalUrl, hero } = Astro.props as Props;

const resolveAbs = (path?: string) => {
  if (!path) return `${GLOBAL.rootUrl}/${GLOBAL.profileImage}`;
  return path.startsWith("http")
    ? path
    : `${GLOBAL.rootUrl}${path.startsWith("/") ? "" : "/"}${path}`;
};
const ogImage = resolveAbs(hero?.image);

const pageSchema = JSON.stringify({
  "@context": "https://schema.org",
  "@type": "AboutPage",
  "name": title,
  "description": description,
  "url": canonicalUrl,
  "image": ogImage,
  "publisher": {
    "@type": "Organization",
    "name": GLOBAL.username,
    "logo": `${GLOBAL.rootUrl}/${GLOBAL.profileImage}`
  }
}).replace(/</g, "\\u003c");
---

<Layout>
  <Fragment slot="head">
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage} />
    <meta property="og:url" content={canonicalUrl} />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage} />
    <link rel="canonical" href={canonicalUrl} />
    <script type="application/ld+json" set:html={pageSchema}></script>
  </Fragment>

  <Section class="my-10">
    <div class="relative rounded-3xl border border-black/10 dark:border-white/10 p-6 sm:p-10 overflow-hidden">
      <div class="absolute inset-0 bg-zinc-50 dark:bg-zinc-900 [mask-image:radial-gradient(white,transparent)]">
        <div class="absolute inset-0 bg-[radial-gradient(theme(colors.black/.1)_1px,transparent_1px)] dark:bg-[radial-gradient(theme(colors.white/.05)_1px,transparent_1px)] [background-size:16px_16px] [mask-image:radial-gradient(ellipse_50%_50%_at_50%_50%,#000_70%,transparent_100%)]"></div>
      </div>
      <div class="relative z-10 flex flex-col justify-end gap-3 min-h-[200px] sm:min-h-[300px]">
        <p class="text-[10px] uppercase tracking-[0.35em] zag-muted">Tentang</p>
        <h1 class="font-display text-4xl sm:text-6xl zag-text">
          {hero?.title ?? GLOBAL.username}
        </h1>
        <p class="max-w-2xl zag-muted">
          {hero?.subtitle ?? description}
        </p>
      </div>
    </div>
  </Section>

  <Section class="py-10">
    <div class="space-y-6">
      <slot />
    </div>
  </Section>
</Layout>
