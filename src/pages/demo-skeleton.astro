---
import Layout from "../layouts/Layout.astro";
import Section from "../components/common/Section.astro";
import SkeletonLoader from "../components/common/SkeletonLoader.astro";
import AffiliateProducts from "../components/AffiliateProducts.astro";
import { loadAffiliateProducts } from "../lib/affiliates";

const demoProducts = (await loadAffiliateProducts()).slice(0, 2);
---

<Layout
    title="Skeleton Loader Demo"
    description="Demo halaman untuk melihat skeleton loader"
>
    <Section class="py-12">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-4xl font-display mb-8">ðŸŽ¨ Skeleton Loader Demo</h1>

            <p class="mb-8 text-lg">
                Skeleton loader adalah placeholder animasi yang ditampilkan saat
                konten sedang dimuat. Scroll ke bawah untuk melihat berbagai
                variant!
            </p>

            <!-- Demo 1: Product Skeleton -->
            <div class="mb-16">
                <h2 class="text-2xl font-display mb-4">1. Product Skeleton</h2>
                <p class="mb-4 text-sm text-gray-600 dark:text-gray-400">
                    Digunakan untuk loading product cards
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold mb-2">
                            Loading State:
                        </h3>
                        <SkeletonLoader variant="product" count={2} />
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold mb-2">
                            Actual Content:
                        </h3>
                        <AffiliateProducts
                            products={demoProducts}
                            title="Produk Demo"
                        />
                    </div>
                </div>
            </div>

            <!-- Demo 2: Article Skeleton -->
            <div class="mb-16">
                <h2 class="text-2xl font-display mb-4">2. Article Skeleton</h2>
                <p class="mb-4 text-sm text-gray-600 dark:text-gray-400">
                    Digunakan untuk loading article previews
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold mb-2">
                            Loading State:
                        </h3>
                        <SkeletonLoader variant="article" count={2} />
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold mb-2">
                            Actual Content:
                        </h3>
                        <div class="space-y-4">
                            <article class="border-b pb-4">
                                <h4 class="text-xl font-bold mb-2">
                                    Judul Artikel Pertama
                                </h4>
                                <p class="text-sm text-gray-500 mb-2">
                                    2025-11-22 â€¢ 5 min
                                </p>
                                <p class="text-gray-700 dark:text-gray-300">
                                    Ini adalah deskripsi artikel yang
                                    menjelaskan isi dari artikel tersebut...
                                </p>
                            </article>
                            <article class="border-b pb-4">
                                <h4 class="text-xl font-bold mb-2">
                                    Judul Artikel Kedua
                                </h4>
                                <p class="text-sm text-gray-500 mb-2">
                                    2025-11-21 â€¢ 7 min
                                </p>
                                <p class="text-gray-700 dark:text-gray-300">
                                    Deskripsi artikel kedua yang memberikan
                                    gambaran tentang konten...
                                </p>
                            </article>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Demo 3: Card Skeleton -->
            <div class="mb-16">
                <h2 class="text-2xl font-display mb-4">3. Card Skeleton</h2>
                <p class="mb-4 text-sm text-gray-600 dark:text-gray-400">
                    Digunakan untuk loading card layouts
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold mb-2">
                            Loading State:
                        </h3>
                        <div class="grid grid-cols-2 gap-4">
                            <SkeletonLoader variant="card" count={2} />
                        </div>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold mb-2">
                            Actual Content:
                        </h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="border rounded-lg overflow-hidden">
                                <div
                                    class="h-32 bg-gradient-to-r from-blue-500 to-purple-500"
                                >
                                </div>
                                <div class="p-4">
                                    <h4 class="font-bold mb-2">Card Title 1</h4>
                                    <p class="text-sm text-gray-600">
                                        Card description here
                                    </p>
                                </div>
                            </div>
                            <div class="border rounded-lg overflow-hidden">
                                <div
                                    class="h-32 bg-gradient-to-r from-green-500 to-teal-500"
                                >
                                </div>
                                <div class="p-4">
                                    <h4 class="font-bold mb-2">Card Title 2</h4>
                                    <p class="text-sm text-gray-600">
                                        Card description here
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Demo 4: Text Skeleton -->
            <div class="mb-16">
                <h2 class="text-2xl font-display mb-4">4. Text Skeleton</h2>
                <p class="mb-4 text-sm text-gray-600 dark:text-gray-400">
                    Digunakan untuk loading text content
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold mb-2">
                            Loading State:
                        </h3>
                        <SkeletonLoader variant="text" count={5} />
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold mb-2">
                            Actual Content:
                        </h3>
                        <p class="text-gray-700 dark:text-gray-300 space-y-2">
                            <span class="block"
                                >Lorem ipsum dolor sit amet, consectetur
                                adipiscing elit.</span
                            >
                            <span class="block"
                                >Sed do eiusmod tempor incididunt ut labore et
                                dolore magna aliqua.</span
                            >
                            <span class="block"
                                >Ut enim ad minim veniam, quis nostrud
                                exercitation ullamco.</span
                            >
                            <span class="block"
                                >Duis aute irure dolor in reprehenderit in
                                voluptate velit.</span
                            >
                            <span class="block"
                                >Excepteur sint occaecat cupidatat non proident.</span
                            >
                        </p>
                    </div>
                </div>
            </div>

            <!-- Demo 5: Circle Skeleton -->
            <div class="mb-16">
                <h2 class="text-2xl font-display mb-4">5. Circle Skeleton</h2>
                <p class="mb-4 text-sm text-gray-600 dark:text-gray-400">
                    Digunakan untuk loading avatars atau circular images
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold mb-2">
                            Loading State:
                        </h3>
                        <div class="flex gap-4">
                            <SkeletonLoader variant="circle" count={3} />
                        </div>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold mb-2">
                            Actual Content:
                        </h3>
                        <div class="flex gap-4">
                            <div
                                class="w-12 h-12 rounded-full bg-gradient-to-r from-pink-500 to-rose-500"
                            >
                            </div>
                            <div
                                class="w-12 h-12 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500"
                            >
                            </div>
                            <div
                                class="w-12 h-12 rounded-full bg-gradient-to-r from-green-500 to-emerald-500"
                            >
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Interactive Demo -->
            <div class="mb-16 p-6 bg-gray-100 dark:bg-gray-800 rounded-lg">
                <h2 class="text-2xl font-display mb-4">ðŸŽ® Interactive Demo</h2>
                <p class="mb-4">
                    Klik tombol untuk toggle antara skeleton dan konten:
                </p>

                <div class="flex gap-4 mb-4">
                    <button
                        id="toggle-product"
                        class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition"
                    >
                        Toggle Product
                    </button>
                    <button
                        id="toggle-article"
                        class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition"
                    >
                        Toggle Article
                    </button>
                    <button
                        id="simulate-loading"
                        class="px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 transition"
                    >
                        Simulate Loading (3s)
                    </button>
                </div>

                <div id="demo-container" class="mt-4">
                    <!-- Content will be dynamically inserted here -->
                </div>
            </div>

            <!-- Code Examples -->
            <div class="mb-16">
                <h2 class="text-2xl font-display mb-4">ðŸ’» Code Examples</h2>

                <div
                    class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto"
                >
                    <pre><code>{`<!-- Product Skeleton -->
<SkeletonLoader variant="product" count={3} />

<!-- Article Skeleton -->
<SkeletonLoader variant="article" count={2} />

<!-- Card Skeleton -->
<SkeletonLoader variant="card" count={4} />

<!-- Text Skeleton -->
<SkeletonLoader variant="text" count={5} />

<!-- Circle Skeleton -->
<SkeletonLoader variant="circle" count={3} />

<!-- Conditional Rendering -->
{loading ? (
  <SkeletonLoader variant="product" count={3} />
) : (
  <ProductList products={products} />
)}`}</code></pre>
                </div>
            </div>
        </div>
    </Section>
</Layout>

<script>
    // Interactive demo functionality
    const demoContainer = document.getElementById("demo-container");
    let showingSkeleton = true;

    function renderProductDemo(showSkeleton: boolean) {
        if (!demoContainer) return;

        if (showSkeleton) {
            demoContainer.innerHTML = `
        <div class="skeleton-product">
          <div class="skeleton skeleton-product-image"></div>
          <div class="skeleton-product-info">
            <div class="skeleton skeleton-product-title"></div>
            <div class="skeleton skeleton-product-price"></div>
          </div>
        </div>
      `;
        } else {
            demoContainer.innerHTML = `
        <div class="flex gap-4 p-4 border rounded-lg">
          <div class="w-20 h-20 bg-gradient-to-r from-orange-500 to-red-500 rounded"></div>
          <div class="flex-1">
            <h4 class="font-bold mb-2">Product Name</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">Product description here</p>
            <p class="font-bold text-lg">Rp 100.000</p>
          </div>
        </div>
      `;
        }
    }

    // Initialize with skeleton
    renderProductDemo(true);

    // Toggle product
    document.getElementById("toggle-product")?.addEventListener("click", () => {
        showingSkeleton = !showingSkeleton;
        renderProductDemo(showingSkeleton);
    });

    // Toggle article
    document.getElementById("toggle-article")?.addEventListener("click", () => {
        showingSkeleton = !showingSkeleton;
        if (showingSkeleton) {
            demoContainer!.innerHTML = `
        <div class="skeleton-article">
          <div class="skeleton skeleton-article-title"></div>
          <div class="skeleton skeleton-article-meta"></div>
          <div class="skeleton skeleton-text"></div>
          <div class="skeleton skeleton-text"></div>
        </div>
      `;
        } else {
            demoContainer!.innerHTML = `
        <article>
          <h3 class="text-2xl font-bold mb-2">Article Title</h3>
          <p class="text-sm text-gray-500 mb-4">2025-11-22 â€¢ 5 min read</p>
          <p class="text-gray-700 dark:text-gray-300">
            This is the article content that would normally be loaded from the server...
          </p>
        </article>
      `;
        }
    });

    // Simulate loading
    document
        .getElementById("simulate-loading")
        ?.addEventListener("click", () => {
            // Show skeleton
            renderProductDemo(true);

            // Show toast
            if (typeof (window as any).showToast === "function") {
                (window as any).showToast("Loading content...", {
                    type: "info",
                    duration: 3000,
                });
            }

            // After 3 seconds, show content
            setTimeout(() => {
                renderProductDemo(false);
                if (typeof (window as any).showToast === "function") {
                    (window as any).showToast("Content loaded!", {
                        type: "success",
                        duration: 2000,
                    });
                }
            }, 3000);
        });
</script>

<style>
    /* Skeleton styles (same as SkeletonLoader.astro) */
    .skeleton {
        background: linear-gradient(
            90deg,
            rgba(0, 0, 0, 0.06) 25%,
            rgba(0, 0, 0, 0.12) 50%,
            rgba(0, 0, 0, 0.06) 75%
        );
        background-size: 200% 100%;
        animation: skeleton-loading 1.5s ease-in-out infinite;
        border-radius: 0.375rem;
    }

    .dark .skeleton {
        background: linear-gradient(
            90deg,
            rgba(255, 255, 255, 0.06) 25%,
            rgba(255, 255, 255, 0.12) 50%,
            rgba(255, 255, 255, 0.06) 75%
        );
        background-size: 200% 100%;
    }

    @keyframes skeleton-loading {
        0% {
            background-position: 200% 0;
        }
        100% {
            background-position: -200% 0;
        }
    }

    .skeleton-product {
        display: flex;
        gap: 1rem;
        padding: 0.75rem;
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 0.5rem;
    }

    .dark .skeleton-product {
        border-color: rgba(255, 255, 255, 0.1);
    }

    .skeleton-product-image {
        width: 5rem;
        height: 5rem;
        flex-shrink: 0;
    }

    .skeleton-product-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        justify-content: center;
    }

    .skeleton-product-title {
        height: 1rem;
        width: 80%;
    }

    .skeleton-product-price {
        height: 1.25rem;
        width: 40%;
    }

    .skeleton-article {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .skeleton-article-title {
        height: 2rem;
        width: 85%;
    }

    .skeleton-article-meta {
        height: 0.875rem;
        width: 30%;
    }

    .skeleton-text {
        height: 1rem;
        width: 100%;
    }
</style>
